#!/usr/bin/env bash
# no set -e, as we want to continue with the next app

# Prepare
mkdir -p "$HOME/bin"

# Atom
app=$(getapp Atom.app)
if is_dir "$app"; then
	ln -fs "$app/Contents/Resources/app/atom.sh" "$HOME/bin/atom"
	ln -fs "$app/Contents/Resources/app/apm/bin/apm" "$HOME/bin/apm"
fi

# Visual Studio Code
app=$(getapp Visual Studio Code.app)
if is_dir "$app"; then
	ln -fs "$app/Contents/Resources/app/bin/code" "$HOME/bin/code"
fi

# GitHub
app=$(getapp GitHub.app)
if is_dir "$app"; then
	ln -fs "$app/Contents/MacOS/github_cli" "$HOME/bin/github"
fi

# Tower
app=$(getapp Tower.app)
if is_dir "$app"; then
	ln -fs "$app/Contents/MacOS/gittower" "$HOME/bin/tower"
fi

# Kaleidoscope
app=$(getapp Kaleidoscope.app)
if is_dir "$app"; then
	ln -fs "$app/Contents/Resources/bin/ksdiff" "$HOME/bin/ksdiff"
fi

# pip
app=$(which pip)
if ! is_nonempty_file "$app"; then
	app=$(which pip2)
	if is_file "$app"; then
		ln -fs "$app" "$HOME/bin/pip"
	fi
fi

# Git Scan
if command_missing "git-scan"; then
	curl -LsS "https://download.civicrm.org/git-scan/git-scan.phar" -o "$HOME/bin/git-scan"
	chmod +x "$HOME/bin/git-scan"
fi
