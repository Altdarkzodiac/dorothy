#!/usr/bin/env bash

# Setup git configuraiton
function gitsetup {
	# General
	git config --global core.excludesfile ~/.gitignore_global
	git config --global push.default simple
	git config --global mergetool.keepBackup false
	git config --global color.ui auto
	git config --global hub.protocol ssh

	# Authentication
	# Use OSX Credential Helper if available, otherwise default to time cache
	if is_mac; then
		git config --global credential.helper osxkeychain
		git config --global diff.tool opendiff
		git config --global merge.tool opendiff
		git config --global difftool.prompt false
		# http://apple.stackexchange.com/a/254619/15131
		if ! silent grep 'AddKeysToAgent yes' < ~/.ssh/config; then
			printf "\nAddKeysToAgent yes" >> ~/.ssh/config
		fi
	else
		git config --global credential.helper cache
		git config credential.helper 'cache --timeout=86400'
	fi
}

gitsetup