#!/usr/bin/env bash

function is-mounted() (
	source "$DOROTHY/sources/strict.bash"

	local mount_source mount_target
	mount_source="$(get-flag-value 'source' -- "$@")"
	mount_target="$(get-flag-value 'target' -- "$@")"

	if test -n "$mount_source" -a -n "$mount_target"; then
		mount | grep --fixed-strings --regexp="${mount_source} on ${mount_target} type "
	elif test -n "$mount_source"; then
		mount | grep --fixed-strings --regexp="${mount_source} on"
	elif test -n "$mount_target"; then
		mount | grep --fixed-strings --regexp="on ${mount_target} type "
	else
		echo "need [--source=...] and/or [--target=...] arguments" >/dev/stderr
		return 22 # Invalid argument
	fi
)

# fire if invoked standalone
if test "$0" = "${BASH_SOURCE[0]}"; then
	is-mounted "$@"
fi
