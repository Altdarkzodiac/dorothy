#!/usr/bin/env bash
source "$DOROTHY/sources/strict.bash"

# help
if is-help "$@"; then
	cat <<-EOF >/dev/stderr
		ABOUT:
		??????
	EOF
	# if test "$#" -ne 0; then
	# 	echo-style $'\n' --error="ERROR:" $'\n' --red="$(echo-lines -- "$@")" >/dev/stderr
	# fi
	return 22 # Invalid argument
fi

if test "$#" -eq 1; then
	outputFile="concat.$1"
	if test -f "$outputFile"; then
		rm "$outputFile"
	fi

	count=0
	find-files --extension="$1" | while read -r inputFile; do
		count=$((count + 1))
		echo -ne "\\r$count $inputFile"
		cat "$inputFile" >>"$outputFile"
	done
else
	echo "concatfiles <extension>"
fi
