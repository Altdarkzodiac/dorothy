#!/usr/bin/env bash
source "$DOROTHY/sources/strict.bash"
source "$DOROTHY/sources/shims.bash"

function echo_eval() {
	# remove superflous --
	while test "$1" = '--'; do
		shift
	done

	# echo and run
	echo-element --open="$(quote "$@")"
	ec=0 && ("$@") || ec="$?"
	echo-element --close="$(quote "$@")" --status="$ec"
	return "$ec"
}

# fire if invoked standalone
if test "$0" = "${BASH_SOURCE[0]}"; then
	echo_eval "$@"
fi
